<!DOCTYPE html><html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Resumo Financeiro Estratégico</title>  <style>
    :root{
      --bg:#0f1115;--card:#181b22;--text:#eaeaf0;--muted:#9aa0aa;
      --accent:#f5c542;--danger:#ff5c5c;--ok:#2ecc71;--warn:#f39c12;
    }
    *{box-sizing:border-box;font-family:Inter,Arial,sans-serif}
    body{margin:0;background:var(--bg);color:var(--text)}
    header{padding:16px;text-align:center;border-bottom:1px solid #222}
    header h1{margin:0;color:var(--accent)}
    header p{margin:6px 0 0;font-size:.85rem;color:var(--muted)}
    main{max-width:520px;margin:auto;padding:16px;display:flex;flex-direction:column;gap:16px}
    .card{background:var(--card);border-radius:14px;padding:16px;box-shadow:0 8px 24px rgba(0,0,0,.35)}
    h2{margin:0 0 10px;color:var(--accent)}
    .row{display:flex;justify-content:space-between;margin:6px 0}
    .ok{color:var(--ok)}
    .bad{color:var(--danger)}
    canvas{width:100%;height:220px}
    footer{text-align:center;font-size:.75rem;color:var(--muted);padding:12px}
  </style></head>
<body><header>
  <h1>Resumo Financeiro</h1>
  <p>Visão estratégica baseada no histórico real</p>
</header><main>  <div class="card">
    <h2>Último Dia</h2>
    <div class="row"><span>Resultado líquido</span><strong id="diaLiquido">–</strong></div>
    <div class="row"><span>Status</span><strong id="diaStatus">–</strong></div>
  </div>  <div id="alerta" class="card" style="display:none;border:1px solid var(--danger)">
    <h2>⚠️ Alerta Inteligente</h2>
    <div id="msgAlerta"></div>
  </div>  <div class="card">
    <h2>Tendência – Últimos Dias</h2>
    <canvas id="grafico"></canvas>
  </div>  <div class="card">
    <h2>Leitura Estratégica (IA)</h2>
    <div id="ia"></div>
  </div></main><footer>
  <a href="index.html" style="color:#f5c542;text-decoration:none">← Voltar ao Dashboard</a>
</footer><script>
const resumo = JSON.parse(localStorage.getItem('ultimoResumo') || '{}');
const historico = JSON.parse(localStorage.getItem('historico') || '[]');

// Último dia
if(resumo.liquido !== undefined){
  document.getElementById('diaLiquido').innerText = 'R$ ' + resumo.liquido.toFixed(2);
  document.getElementById('diaStatus').innerText = resumo.ok ? 'Sustentável' : 'Crítico';
  document.getElementById('diaStatus').className = resumo.ok ? 'ok' : 'bad';
}

// Gráfico de barras
const canvas = document.getElementById('grafico');
const ctx = canvas.getContext('2d');
const dados = historico.slice(-14); // últimos 14 dias
const max = Math.max(...dados.map(d=>Math.abs(d.liquido)), 1);

const w = canvas.width = canvas.offsetWidth;
const h = canvas.height = 220;
const barW = w / dados.length;

ctx.clearRect(0,0,w,h);
ctx.translate(0, h/2);

// eixo zero
ctx.strokeStyle = '#333';
ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(w,0); ctx.stroke();

// barras
dados.forEach((d,i)=>{
  const val = d.liquido;
  const barH = (val / max) * (h/2 - 10);
  ctx.fillStyle = d.crise ? '#ff5c5c' : '#2ecc71';
  ctx.fillRect(i*barW + 4, -barH, barW - 8, barH);
});

// IA estratégica
let msg = '';
const diasCrise = dados.filter(d=>d.crise).length;
if(diasCrise >= 3){
  msg = 'Sequência crítica detectada. Reduza drasticamente custos e evite qualquer compromisso financeiro.';
} else if(resumo.ok){
  msg = 'Tendência positiva recente. Continue conservador e avance com disciplina.';
} else {
  msg = 'Cenário instável. Atenção máxima às decisões diárias.';
}

document.getElementById('ia').innerText = msg;

// Alertas inteligentes
if(diasCrise >= 3){
  const a = document.getElementById('alerta');
  a.style.display = 'block';
  document.getElementById('msgAlerta').innerText = 'Foram detectados 3 ou mais dias seguidos em modo crise. Recomenda-se PAUSAR pagamentos, reduzir operação e reavaliar rotas e horários.';
}
</script></body>
</html>